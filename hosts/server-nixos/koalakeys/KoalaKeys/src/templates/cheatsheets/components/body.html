<body class="dark-mode">
    <div class="top-content">
        <button id="category-nav-toggle" aria-label="Toggle category navigation">
            <svg xmlns="http://www.w3.org/2000/svg"
                 width="24"
                 height="24"
                 viewBox="0 0 24 24"
                 fill="none"
                 stroke="currentColor"
                 stroke-width="2"
                 stroke-linecap="round"
                 stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>
        <h1>{{ title }}</h1>
        <div class="search-container">
            <input type="text" id="shortcut-search" placeholder="Search shortcuts..." />
        </div>
        <button id="dark-mode-toggle"
                class="dark-mode-toggle"
                aria-label="Toggle dark mode">
            <span id="theme-icon">◐</span>
        </button>
    </div>
    <nav id="category-nav" aria-label="Category navigation">
        <ul>
            {% for section in shortcuts.keys() %}
                <li>
                    <a href="#{{ section | replace(' ', '-') | lower }}">{{ section }}</a>
                </li>
            {% endfor %}
        </ul>
    </nav>
    <div id="content-wrapper">
        {% if render_keys %}
            <p class="layout-info">Keyboard Layout: {{ layout.keyboard }} | System: {{ layout.system }}</p>
            <!-- Keyboard Visualization -->
            <div id="keyboard-container">
                <div id="keyboard"
                     data-layout="{{ layout.keyboard }}"
                     data-system="{{ layout.system }}">
                    <!-- Keyboard rows will be dynamically generated -->
                    <div class="row">
                        <div class="key" data-key="Esc">Esc</div>
                        <div class="key" data-key="F1">F1</div>
                        <div class="key" data-key="F2">F2</div>
                        <div class="key" data-key="F3">F3</div>
                        <div class="key" data-key="F4">F4</div>
                        <div class="key" data-key="F5">F5</div>
                        <div class="key" data-key="F6">F6</div>
                        <div class="key" data-key="F7">F7</div>
                        <div class="key" data-key="F8">F8</div>
                        <div class="key" data-key="F9">F9</div>
                        <div class="key" data-key="F10">F10</div>
                        <div class="key" data-key="F11">F11</div>
                        <div class="key" data-key="F12">F12</div>
                    </div>
                    <div class="row">
                        <div class="key" data-key="`">` ~</div>
                        <div class="key" data-key="1">1 !</div>
                        <div class="key" data-key="2">2 @</div>
                        <div class="key" data-key="3">3 #</div>
                        <div class="key" data-key="4">4 $</div>
                        <div class="key" data-key="5">5 %</div>
                        <div class="key" data-key="6">6 ^</div>
                        <div class="key" data-key="7">7 &amp;</div>
                        <div class="key" data-key="8">8 *</div>
                        <div class="key" data-key="9">9 (</div>
                        <div class="key" data-key="0">0 )</div>
                        <div class="key" data-key="-">- _</div>
                        <div class="key" data-key="=">=+</div>
                        <div class="key key__backspace" data-key="Backspace">Backspace</div>
                    </div>
                    <div class="row">
                        <div class="key key__tab" data-key="Tab">Tab</div>
                        <div class="key" data-key="Q">Q</div>
                        <div class="key" data-key="W">W</div>
                        <div class="key" data-key="E">E</div>
                        <div class="key" data-key="R">R</div>
                        <div class="key" data-key="T">T</div>
                        <div class="key" data-key="Y">Y</div>
                        <div class="key" data-key="U">U</div>
                        <div class="key" data-key="I">I</div>
                        <div class="key" data-key="O">O</div>
                        <div class="key" data-key="P">P</div>
                        <div class="key" data-key="[">[{</div>
                        <div class="key" data-key="]">]}</div>
                        <div class="key key__wide" data-key="\">\|</div>
                    </div>
                    <div class="row">
                        <div class="key key__caps" data-key="CapsLock">Caps Lock</div>
                        <div class="key" data-key="A">A</div>
                        <div class="key" data-key="S">S</div>
                        <div class="key" data-key="D">D</div>
                        <div class="key" data-key="F">F</div>
                        <div class="key" data-key="G">G</div>
                        <div class="key" data-key="H">H</div>
                        <div class="key" data-key="J">J</div>
                        <div class="key" data-key="K">K</div>
                        <div class="key" data-key="L">L</div>
                        <div class="key" data-key=";">; :</div>
                        <div class="key" data-key="'">' "</div>
                        <div class="key key__enter" data-key="Enter">Enter</div>
                    </div>
                    <div class="row">
                        <div class="key key__shift-left" data-key="Shift">Shift</div>
                        <div class="key" data-key="Z">Z</div>
                        <div class="key" data-key="X">X</div>
                        <div class="key" data-key="C">C</div>
                        <div class="key" data-key="V">V</div>
                        <div class="key" data-key="B">B</div>
                        <div class="key" data-key="N">N</div>
                        <div class="key" data-key="M">M</div>
                        <div class="key" data-key=",">&lt;, &gt;</div>
                        <div class="key" data-key=".">. &gt;</div>
                        <div class="key" data-key="/">/ ?</div>
                        <div class="key key__right-shift" data-key="Shift">Shift</div>
                    </div>
                    <div class="row">
                        <div class="key key__bottom-funct" data-key="Ctrl">CTRL</div>
                        <div class="key key__bottom-funct" data-key="Alt">ALT</div>
                        <div class="key key__bottom-funct" data-key="Cmd">CMD</div>
                        <div class="key key__spacebar" data-key="Space">SPACE</div>
                        <div class="key key__bottom-funct" data-key="Cmd">CMD</div>
                        <div class="key key__bottom-funct" data-key="Alt">ALT</div>
                        <div class="key key__bottom-funct" data-key="Ctrl">CTRL</div>
                        <div class="key key__arrow" data-key="Left">←</div>
                        <div class="key key__arrow" data-key="Up">↑</div>
                        <div class="key key__arrow" data-key="Down">↓</div>
                        <div class="key key__arrow" data-key="Right">→</div>
                    </div>
                </div>
            </div>
        {% endif %}
        {% for section, shortcuts in shortcuts.items() %}
            <div class="section" id="{{ section | replace(' ', '-') | lower }}">
                <h2>{{ section }}</h2>
                <div class="shortcuts-container">
                    {% for shortcut, details in shortcuts.items() %}
                        <div class="shortcut"
                             {% if not allow_text %}title="Click to highlight on keyboard"{% endif %}>
                            <div class="shortcut-key {% if allow_text %}text-shortcut{% endif %}">
                                {% if allow_text %}
                                    {{ shortcut }}
                                {% else %}
                                    {% for key in shortcut.split('<sep>') %}
                                        <span class="key-part">{{ key | safe }}</span>
                                        {% if not loop.last %}<span class="separator">+</span>{% endif %}
                                    {% endfor %}
                                {% endif %}
                            </div>
                            <div class="shortcut-description">{{ details.description }}</div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endfor %}
    </div>
